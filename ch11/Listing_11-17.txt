// Listing 11.17 Allowing checkedIds to be controlled in the useChecked.ts file in the src/Checklist folder.

import { useState, useEffect } from "react";
import { IdValue } from "./types";

type Params = {
    checkedIds?: IdValue[];
    onCheckedIdsChange?: (checkedIds: IdValue[]) => void;
};

export function useChecked({ checkedIds, onCheckedIdsChange }: Params) {
    const [resolvedCheckedIds, setResolvedCheckedIds] =
        useState<IdValue[]>(checkedIds ?? []);

    const handleCheckChange = (checkedId: IdValue) => () => {
        const isChecked = resolvedCheckedIds.includes(checkedId);
        let newCheckedIds = isChecked ?
            resolvedCheckedIds.filter((itemCheckedid) => itemCheckedid !== checkedId)
            : resolvedCheckedIds.concat(checkedId);
        setResolvedCheckedIds(newCheckedIds);
    }

    return { handleCheckChange, resolvedCheckedIds };
}